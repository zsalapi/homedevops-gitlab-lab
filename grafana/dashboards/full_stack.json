{
  "annotations": { "list": [] },
  "panels": [
    {
      "type": "graph",
      "title": "GitLab CPU Usage",
      "targets": [
        { "expr": "rate(container_cpu_usage_seconds_total{name=\"gitlab\"}[1m])", "legendFormat": "GitLab CPU" }
      ],
      "gridPos": { "x": 0, "y": 0, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "GitLab Memory Usage",
      "targets": [
        { "expr": "container_memory_usage_bytes{name=\"gitlab\"}", "legendFormat": "GitLab Memory" }
      ],
      "gridPos": { "x": 12, "y": 0, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "GitLab Running Jobs",
      "targets": [
        { "expr": "gitlab_ci_running_jobs_total", "legendFormat": "Running Jobs" }
      ],
      "gridPos": { "x": 0, "y": 6, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "GitLab Pipeline Status",
      "targets": [
        { "expr": "gitlab_ci_pipelines_total{status='success'}", "legendFormat": "Success" },
        { "expr": "gitlab_ci_pipelines_total{status='failed'}", "legendFormat": "Failed" }
      ],
      "gridPos": { "x": 12, "y": 6, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "Nginx Requests per Second",
      "targets": [
        { "expr": "rate(nginx_http_requests_total[1m])", "legendFormat": "Requests/sec" }
      ],
      "gridPos": { "x": 0, "y": 12, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "Nginx 4xx/5xx Responses",
      "targets": [
        { "expr": "rate(nginx_http_requests_total{status=~'4..'}[1m])", "legendFormat": "4xx" },
        { "expr": "rate(nginx_http_requests_total{status=~'5..'}[1m])", "legendFormat": "5xx" }
      ],
      "gridPos": { "x": 12, "y": 12, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "Node CPU Usage",
      "targets": [
        { "expr": "rate(node_cpu_seconds_total[1m])", "legendFormat": "{{mode}}" }
      ],
      "gridPos": { "x": 0, "y": 18, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "Node Memory Usage",
      "targets": [
        { "expr": "node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes * 100", "legendFormat": "Available %" }
      ],
      "gridPos": { "x": 12, "y": 18, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "Node Disk Usage",
      "targets": [
        { "expr": "node_filesystem_avail_bytes / node_filesystem_size_bytes * 100", "legendFormat": "{{mountpoint}}" }
      ],
      "gridPos": { "x": 0, "y": 24, "w": 12, "h": 6 }
    },
    {
      "type": "graph",
      "title": "Node Network Traffic",
      "targets": [
        { "expr": "rate(node_network_receive_bytes_total[1m])", "legendFormat": "RX" },
        { "expr": "rate(node_network_transmit_bytes_total[1m])", "legendFormat": "TX" }
      ],
      "gridPos": { "x": 12, "y": 24, "w": 12, "h": 6 }
    }
  ],
  "title": "Full Stack Monitoring",
  "schemaVersion": 27,
  "version": 1
}
